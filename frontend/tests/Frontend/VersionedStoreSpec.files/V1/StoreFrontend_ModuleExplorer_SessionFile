"(namespace \"free\")\n\n(module hello-world MODULE_ADMIN\n  \"A smart contract to greet the world.\"\n  (defcap MODULE_ADMIN () true)\n\n  (defschema message-schema\n    @doc \"Message schema\"\n    @model [(invariant (!= msg \"\"))]\n\n    msg:string)\n\n  (deftable\n    message:{message-schema})\n\n  (defun set-message\n    (\n      m:string\n    )\n    \"Set the message that will be used next\"\n    (enforce (!= m \"\") \"set-message: must not be empty\")\n    (write message \"0\" {\"msg\": m})\n  )\n\n  (defun greet ()\n    \"Do the hello-world dance\"\n    (with-default-read message \"0\" { \"msg\": \"\" } { \"msg\":= msg }\n      (format \"Hello {}!\" [msg])))\n)\n\n(create-table message)\n\n(set-message \"world\")\n(greet)"
